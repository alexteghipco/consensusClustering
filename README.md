# consensusClustering
Package for performing consensus clustering in MATLAB using a number of different unsupervised machine learning methods. Consensus clustering is an ensemble clustering method. You can use this package to cluster subsamples of your dataset many different times, creating a consensus matrix that represents how often each pair of samples was placed in the same cluster. Consensus matrices can be used to evaluate the reliability of a particular clustering approach, find the most reliable clustering solution, and/or fuse different clustering approaches together into a cluster ensemble. This package will help in doing all of the above. 

consensusClustering can create cluster ensembles using: k-means, k-medoids, self-tuning spectral clustering, affinity propagation, and louvain clustering using different distance metrics. consensusSelection computes a number of measures for each consensus matrix, allowing you to evaluate the most reliable clustering solutions. First, it implements traditional visual methods for selecting a clustering solution based on consensus using a combination of: consensus histograms, cumulative distribution function curves, and the area under these curves. It also implements an arguably better measure of solution reliability: the Proportion of Ambigously Clustered pairs (PAC). I have found this measure to overfit for large clustering solutions and have additionally developed a way to integrate other statistical measures with PAC to select the optimal solution. These measures include the dip statistic for testing whether a distribution is significantly multimodal, and the bimodality coefficient for measuring the degree to which a distribution is bimodal. This package can implement a method for automatically using these measures to select an optimal solution (in optimalConsensus) but you can choose to rely only one of the additional measures we use (which is also reasonable). The key to our method for selecting optimal solutions is simply using these other measures to constrain the PAC curve to the region that reflects bimodal consensus matrices.

For full description of the method see methods section of 2nd chapter in: Parcellating speech networks using connectivity and multivariate meta-analysis (28863591). [Doctoral dissertation, University of California, Irvine]. ProQuest. 

If you are clustering data from different sources, like within participants, this package can also help you find group-level solutions by fusing consensus matrices at the lower-level. For example, the relatively optimal solutions selected within participants can be adjusted based on the group distribution. If the solution selected for a participant is unreliable relative to the group, it can be made more reliable by focusing on a less complex solution. For full description of the method see methods section of 2nd chapter in: Parcellating speech networks using connectivity and multivariate meta-analysis (28863591). [Doctoral dissertation, University of California, Irvine]. ProQuest. 

This code and the methods were generated for: Teghipco, A., Kundu, P., Buchsbaum, B., Bandettini, P. & Hickok, G. Functional parcellation of the posterior perisylvian zone. A version of this paper is available in Teghipco, A. (2021). Parcellating speech networks using connectivity and multivariate meta-analysis (28863591). [Doctoral dissertation, University of California, Irvine]. ProQuest. Note, I have tried to make this code more flexible than what was originally used for the paper, but you can call this an "alpha" release. 

This repository was refined for clustering CNN saliency maps in the below preprint. To replicate our analyses, ignore the group-level adjustment of subject-level solutions as it does not apply. Restrict the PAC curve for model selection based on dip statistic p-values. Select other parameters based on the values reported in our supplemental material: Teghipco, A., Newman-Norlund, R., Fridriksson, J., Rorden, C., & Bonilha, L. (2023). Distinct brain morphometry patterns revealed by deep learning improve prediction of aphasia severity. Research Square.

Better documentation and debugging is forthcoming. Send any questions/comments to: alex.teghipco@sc.edu
